# CSV 格式导入指南

## 快速开始

您可以直接将飞书文档导出的 CSV 文件导入到系统中。

## CSV 文件格式

### 标题行（第一行）

CSV 文件的第一行必须包含字段名。系统支持以下字段：

| 字段名 | 别名 | 是否必填 | 说明 |
|--------|------|---------|------|
| 效果 | effect | ✅ 必填 | 提示词的效果/标题 |
| 描述 | description | ✅ 必填 | 详细描述 |
| 提示词 | prompt | ✅ 必填 | 提示词内容 |
| 引用来源 | 来源, source | ✅ 必填 | 来源链接或说明 |
| 评测对象 | tags, 标签 | 可选 | 标签，用逗号分隔 |
| 参考图 | imageUrl, 图片 | 可选 | 图片URL |
| 说明 | - | 可选 | 额外说明（会合并到描述中） |
| 创建时间 | createdAt | 可选 | 创建时间 |
| 最后更新时间 | updatedAt, 修改时间 | 可选 | 更新时间 |
| 日期 | - | 可选 | 作为备选日期字段 |

### 示例 CSV 格式

```csv
描述,评测对象,提示词,参考图,效果,说明,引用来源,日期,最后更新时间
连环画创作,Nano Banana2,帮我生成一个8页的连环画...,image.png,斑马大象连环画,趣味性,https://example.com,2025-11-20,2025-11-24
珠海手账图,Nano Banana2,生成中国珠海的旅游指南...,map.png,旅游手账,实用性,https://example.com,2025-11-20,2025-11-22
```

## 从飞书文档导出 CSV

### 方法 1：直接导出

1. 打开飞书文档表格
2. 点击右上角的"..."菜单
3. 选择"导出" → "CSV"
4. 下载文件

### 方法 2：复制粘贴

1. 在飞书表格中全选所有数据（包括标题行）
2. 复制 (Ctrl+C / Cmd+C)
3. 粘贴到文本编辑器
4. 另存为 `.csv` 文件，编码选择 **UTF-8**

## 导入步骤

### 在管理后台导入

1. 访问 http://localhost:3000/admin
2. 点击"导入数据"按钮
3. 选择"CSV 文件"选项卡
4. 上传您的 CSV 文件
5. 预览文件内容
6. 选择导入模式：
   - **合并**：保留现有数据，只添加新数据（根据"效果"字段判断重复）
   - **替换**：清空现有数据后导入
7. 点击"开始导入"

## 字段映射规则

系统会自动识别以下字段：

### 效果/标题
- 字段名：`效果`, `effect`, `title`
- 示例：`"生成产品营销文案"`

### 描述
- 字段名：`描述`, `description`, `desc`
- 如果有"说明"字段，会自动合并
- 示例：`"帮助你快速生成吸引人的产品营销文案"`

### 提示词
- 字段名：`提示词`, `prompt`, `content`
- 示例：`"请为以下产品生成一段吸引人的营销文案..."`

### 来源
- 字段名：`引用来源`, `来源`, `source`, `提示词来源`
- 示例：`"https://mp.weixin.qq.com/s/xxx"`

### 标签
- 字段名：`评测对象`, `tags`, `标签`
- 支持格式：
  - 逗号分隔：`"营销,文案,电商"`
  - 中文逗号：`"营销，文案，电商"`
  - 顿号：`"营销、文案、电商"`
- 示例：`"营销,文案,创意"`

### 图片
- 字段名：`参考图`, `imageUrl`, `图片`, `image`
- 支持多个图片URL（用逗号分隔，系统会使用第一个）
- 示例：`"https://example.com/image.png"`

### 时间
- 创建时间：`创建时间`, `createdAt`
- 更新时间：`最后更新时间`, `updatedAt`, `修改时间`, `日期`
- 支持格式：ISO 8601, `YYYY/MM/DD`, `YYYY-MM-DD`

## 常见问题

### Q: 导入后看不到数据？

**A:** 检查以下几点：
1. 确保 CSV 文件包含标题行
2. 检查必填字段（效果、描述、提示词、来源）是否完整
3. 如果选择"合并"模式，检查是否因"效果"字段重复而被跳过
4. 查看导入结果提示，了解实际导入数量

### Q: 中文乱码怎么办？

**A:** 确保 CSV 文件编码为 **UTF-8**：
1. 在 Excel 中：另存为 → CSV UTF-8（逗号分隔）
2. 在记事本中：另存为 → 编码选择 UTF-8
3. 在 VS Code 中：右下角点击编码 → 使用编码保存 → UTF-8

### Q: 标签没有正确分割？

**A:** 标签支持多种分隔符：
- 英文逗号：`,`
- 中文逗号：`，`
- 顿号：`、`

确保标签之间使用这些分隔符之一。

### Q: 图片字段包含多个URL怎么办？

**A:** 如果图片字段包含多个URL（用逗号分隔），系统会自动使用第一个URL。

### Q: 如何批量更新数据？

**A:** 
1. 先导出现有数据（访问 http://localhost:3000/api/prompts）
2. 在 Excel 中修改
3. 导出为 CSV
4. 使用"替换"模式重新导入

### Q: 某些字段是空的可以导入吗？

**A:** 
- 必填字段（效果、描述、提示词、来源）不能为空
- 可选字段（标签、图片、时间）可以为空

## 技术支持

如有问题，请：
1. 检查浏览器控制台错误信息
2. 查看导入结果提示
3. 参考主文档 `README.md`
4. 查看导入指南 `docs/IMPORT_GUIDE.md`

